  <div id="readme" class="readme blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="text"><table>
<tbody><tr>
<td width="25%">
<i></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
练习7
</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
同步运行作业并上载数据：处理数据
</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C:\FMEData2018\Resources\RESTAPI\Chapter4Exercise7\12656-datapoints.csv
</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">总体目标</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用单个调用上传数据并运行作业。 </font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演示</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何使用处理数据调用</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启动工作空间</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C:\FMEData2018\Resources\RESTAPI\Chapter4Exercise7\Chapter4Exercise7.Start.fmw
</font></font></td>
</tr>
<tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">结束工作空间</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C:\FMEData2018\Resources\RESTAPI\Chapter4Exercise7\Chapter4Exercise7.Complete.fmw
</font></font></td>
</tr>
</tbody></table>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transact Data调用的工作方式是上传数据并通过对服务器的调用来运行工作空间。</font><font style="vertical-align: inherit;">它将按原样运行工作空间，并将输出写入写模块中指定的位置。</font><font style="vertical-align: inherit;">这对于将新数据插入数据库很有用。</font><font style="vertical-align: inherit;">调用完成后，FME Server将返回200 OK消息。</font><font style="vertical-align: inherit;">这表示调用已成功提交。</font><font style="vertical-align: inherit;">但是，它不会提供有关作业是否在FME Server上成功完成的反馈。</font><font style="vertical-align: inherit;">建议定期检查服务器以确保您的作业在FME Server上成功运行。</font><font style="vertical-align: inherit;">获取作业状态也可以通过REST API完成。</font><font style="vertical-align: inherit;">这些调用将在</font></font><a href="https://safe-software.gitbooks.io/fme-server-rest-api-training-2018/content/FMESERVER_RESTAPI4Workspaces/4.6.Exercise.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">练习8中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显示</font><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们首先创建一个与Transact Data调用兼容的工作空间。</font></font></p>
<p><br><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1）打开Chapter4Exercise7.Start工作空间</font></font></strong></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">启动FME Workbench并打开Chapter4Exercise7.Start.fmw工作空间。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是一个非常简单的工作空间，它读取CSV文件并生成Shapefile。</font></font></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.1.Workspace.png"><img src="./Images/image4.4.1.Workspace.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，此转换在此调用中需要进行一项重要更改。</font><font style="vertical-align: inherit;">CSV必须是可选参数。</font><font style="vertical-align: inherit;">这是因为数据将在POST请求的主体中发送到URL，而不是通过在工作空间中设置源数据集参数的路径。</font><font style="vertical-align: inherit;">需要保留源数据集参数以使其无效，因此我们需要使其成为可选项，以防止工作空间引发错误。</font></font></p>
<p><br><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2）将源数据集已发布参数设置为可选</font></font></strong></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过右键单击已发布的参数并选择“编辑定义”，将“源数据集发布的参数”设置为可选。</font></font></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.2.published.png"><img src="./Images/image4.4.2.published.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后在参数设置中选择可选设置。</font></font></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.3.Option.png"><img src="./Images/image4.4.3.Option.png" alt="" style="max-width:100%;"></a></p>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您没有使用培训机器，您也可以设置默认值来浏览您的读模块数据集</font></font></strong></p>
<pre><code>C:\FMEData2018\Resources\RESTAPI\Chapter4Exercise7\12656-datapoints.csv
</code></pre>
<p><br><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3）在FME Server中为输出创建一个文件夹</font></font></strong></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先，转到您的FME Server并登录restapi帐户。</font><font style="vertical-align: inherit;">在页面的左侧找到“资源”并单击它。</font><font style="vertical-align: inherit;">接下来，单击“数据”。</font><font style="vertical-align: inherit;">最后，单击“创建文件夹”并给其取名为</font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RESTTraining</font></font></strong></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建文件夹后，我们可以通过检查文件夹找到该文件夹​​的路径。</font><font style="vertical-align: inherit;">然后，转到Actions并选择Properties。</font></font></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.4.Resources.png"><img src="./Images/image4.4.4.Resources.png" alt="" style="max-width:100%;"></a></p>
<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择RESTTraining文件，然后选择Actions</font></font></em></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.5.Properties.png"><img src="./Images/image4.4.5.Properties.png" alt="" style="max-width:100%;"></a></p>
<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择属性</font></font></em></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.6.FilePaths.png"><img src="./Images/image4.4.6.FilePaths.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制系统路径。</font></font></p>
<p><br><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4）将Shapefile目标更新为您的FME Server中的共享资源文件</font></font></strong></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回FME Workbench，将Shapefile更改为FME Server中的目标文件。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要执行此操作，请右键单击DestDataset已发布参数，然后单击“编辑值”。</font><font style="vertical-align: inherit;">然后，将文件路径插入共享资源。</font></font></p>
<pre><code>$(FME_SHAREDRESOURCE_DATA)/RESTTraining
</code></pre>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.7.DestinationData.png"><img src="./Images/image4.4.7.DestinationData.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在发布之前保存工作空间。</font></font></p>
<p><br><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5）将工作空间上传到FME Server</font></font></strong></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在，是时候将工作空间上传到您的FME Server了。</font><font style="vertical-align: inherit;">这可以通过单击“发布到FME Server”按钮或从菜单栏中选择“文件”&gt;“发布到FME Server”来完成。</font></font></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.8.UploadWorkspace.png"><img src="./Images/image4.4.8.UploadWorkspace.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于这是我们第一次连接到我们的FME Server，我们需要创建一个新连接，因此在Publish to FME Server向导中，从下拉菜单中选择A添加Web连接。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在打开的对话框中输入培训讲师提供的参数。</font><font style="vertical-align: inherit;">在大多数情况下，参数如下：</font></font></p>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FME ServerURL：</font></font></strong> <a href="http://localhost/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http：// localhost</font></font></a></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户名：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> restapi</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">密码：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> restapi</font></font></li>
</ul>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.9.ServerConnection.png"><img src="./Images/image4.4.9.ServerConnection.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单击“验证”以确认连接并返回上一个对话框。</font><font style="vertical-align: inherit;">确保选中新定义的连接，然后单击“下一步”继续。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本练习中，我们将通过单击“新建”按钮创建新的存储库。</font><font style="vertical-align: inherit;">出现提示时输入名称RESTTraining。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将工作空间保存为Chapter4Exercise7.Complete并选中复选框以上传数据文件。</font></font></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.9b.UploadSettings.png"><img src="./Images/image4.4.9b.UploadSettings.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">然后单击“下一步”继续向导。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在向导的最后一个屏幕中，我们可以注册工作空间以使用各种服务。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择Job Submitter服务，因为这是我们现在使用的唯一服务。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单击“发布”以完成发布工作空间。</font></font></p>
<p><br><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6）在FME Server中运行工作空间</font></font></strong></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在我们将作为restapi用户访问我们的FME Server以证明其有效。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在左侧菜单中，我们将看到“运行工作空间”选项卡。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在选择以下选项：</font></font></p>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">存储库：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RESTTraining</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作空间：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chapter4Exercise7.Complete.fmw</font></font></li>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Job Submitter</font></font></li>
</ul>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在点击Run！
</font></font><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.10.run.png"><img src="./Images/image4.4.10.run.png" alt="" style="max-width:100%;"></a></p>
<p><br><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7）检查Shapefile是否已成功生成</font></font></strong></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">转到资源&gt;数据&gt; RESTTraining并确保生成Shapefile。</font></font></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.11.Resources.png"><img src="./Images/image4.4.11.Resources.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除Shapefile。</font><font style="vertical-align: inherit;">这是通过选择“所有文件”，然后选择“操作”并选择“删除”来完成的。</font><font style="vertical-align: inherit;">我们正在删除Shapefile，因为我们将使用REST API再次提交此作业。</font></font></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.11b.Deletes.png"><img src="./Images/image4.4.11b.Deletes.png" alt="" style="max-width:100%;"></a></p>
<p><br><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8）使用Postman完成Transact Data调用</font></font></strong></p>
<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，此调用需要授权</font></font></em></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单击加号按钮以创建新选项卡。</font><font style="vertical-align: inherit;">我们现在将使用该调用来处理数据以上传CSV文件并通过REST API运行工作空间。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用是：</font></font></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

&lt;style type =“text / css”&gt; .tg {border-collapse：collapse; border-spacing：0;} .tg td {font-family：Arial，sans-serif; font-size：14px; padding：10px 5px ; border-style：solid; border-width：1px; overflow：hidden; word-break：normal; border-color：black;} .tg th {font-family：Arial，sans-serif; font-size：14px; font-weight：normal; padding：10px 5px; border-style：solid; border-width：1px; overflow：hidden; word-break：normal; border-color：black;} .tg .tg-ao4k {background-color ：＃e6ffe6;颜色：＃333333; vertical-align：top} .tg .tg-a080 {background-color：＃e6ffe6; vertical-align：top} &lt;/ style&gt;
</font></font><table>
  <tbody><tr>
    <th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">POST</font></font></th>
    <th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP：// &lt;yourServerHost&gt; /fmerest/v3/transformations/transactdata/RESTTraining/Chapter4Exercise7.Complete.fmw</font></font></th>
  </tr>
</tbody></table>
<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您将工作空间保存到其他存储库，则必须修改上面的调用</font></font></strong></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在Postman中使用以下参数设置调用：</font></font></p>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Authorization：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fmetoken token = &lt;yourToken&gt;</font></font></li>
</ul>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要输入令牌，我们可以使用之前创建的预设。</font><font style="vertical-align: inherit;">在键值中，键入单词“令牌”，将显示创建的预设。</font></font></p>
<ul>
<li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accept：</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> application / json</font></font></li>
</ul>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.12.Call.png"><img src="./Images/image4.4.12.Call.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要上传的文件将在调用主体中发送。</font><font style="vertical-align: inherit;">单击body选项卡，然后单击二进制按钮。</font><font style="vertical-align: inherit;">这将为您提供上传文件的选项。</font><font style="vertical-align: inherit;">选择C：/ FMEData2018 / Resources / RESTAPI / Chapter4 / Exercise7中的12656-datapoints.csv。</font><font style="vertical-align: inherit;">然后按“发送”按钮运行调用。</font></font></p>
<p><a target="_blank" rel="noopener noreferrer" href="./Images/image4.4.13.UploadPostman.png"><img src="./Images/image4.4.13.UploadPostman.png" alt="" style="max-width:100%;"></a></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">你应该收到一条消息200 OK这表示调用已经完成。</font><font style="vertical-align: inherit;">检查FME Server中的“作业”页面以确认作业已正确提交。</font><font style="vertical-align: inherit;">另外，检查输出位置以查看Shapefile是否已创建。</font></font></p>
<hr>

<table>
<tbody><tr>
<td>
<i></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
恭喜
</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">

通过完成本练习，您已学会如何：
</font></font><br>
<ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用处理数据(Transact Data)调用上传文件并在一次调用中运行工作空间 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修改要与Transact Data一起使用的工作空间的参数 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 使用共享资源作为文件输出位置 </font></font></li>


</ul></td>
</tr>
</tbody></table>
</article>
  </div>
